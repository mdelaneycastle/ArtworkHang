<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Floor Plan</title>
    <style>
        body {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            background-color: #f0f0f0;
        }
        #floor-plan {
            width: 800px;
            height: 400px;
            border: 2px solid #000;
            position: relative;
            background-color: #fff;
        }
        .block {
            width: 50px;
            height: 50px;
            background-color: #3498db;
            position: absolute;
            cursor: move;
        }
        button {
            position: absolute;
            top: 10px;
            left: 10px;
        }
    </style>
</head>
<body>
    <div id="floor-plan">
        <button onclick="addBlock()">Add Block</button>
    </div>
    <script>
        let blockCounter = 0;

        function addBlock() {
            const block = document.createElement('div');
            block.classList.add('block');
            block.style.left = '10px';
            block.style.top = '10px';
            block.id = 'block-' + blockCounter;
            blockCounter++;
            block.onmousedown = startDrag;
            document.getElementById('floor-plan').appendChild(block);
        }

        function startDrag(event) {
            const block = event.target;
            let shiftX = event.clientX - block.getBoundingClientRect().left;
            let shiftY = event.clientY - block.getBoundingClientRect().top;

            function moveAt(pageX, pageY) {
                let newLeft = pageX - shiftX;
                let newTop = pageY - shiftY;

                // Boundary conditions
                if (newLeft < 0) {
                    newLeft = 0;
                }
                if (newTop < 0) {
                    newTop = 0;
                }
                if (newLeft + block.offsetWidth > floorPlan.offsetWidth) {
                    newLeft = floorPlan.offsetWidth - block.offsetWidth;
                }
                if (newTop + block.offsetHeight > floorPlan.offsetHeight) {
                    newTop = floorPlan.offsetHeight - block.offsetHeight;
                }

                block.style.left = newLeft + 'px';
                block.style.top = newTop + 'px';
            }

            function onMouseMove(event) {
                moveAt(event.pageX, event.pageY);
            }

            moveAt(event.pageX, event.pageY); // Move to the initial position on mousedown

            document.addEventListener('mousemove', onMouseMove);

            function onMouseUp() {
                document.removeEventListener('mousemove', onMouseMove);
                block.onmouseup = null;
            }

            document.addEventListener('mouseup', onMouseUp, { once: true });

            block.ondragstart = function() {
                return false;
            };
        }

        const floorPlan = document.getElementById('floor-plan');
    </script>
</body>
</html>
